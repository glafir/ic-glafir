(function(){Ext.apply(window,{grid:function(e,t){return t=t||"title",e&&"title"===t?Ext.ComponentQuery.query('grid[title="'+e+'"]')[0]||Ext.ComponentQuery.query('treepanel[title="'+e+'"]')[0]:e&&"name"===t?Ext.ComponentQuery.query('grid[name="'+e+'"]')[0]||Ext.ComponentQuery.query('treepanel[name="'+e+'"]')[0]:Ext.ComponentQuery.query("grid{isVisible(true)}")[0]||Ext.ComponentQuery.query("treepanel{isVisible(true)}")[0]},expandRowCombo:function(e){var t,n,r;return n=(r=r||this.grid()).getPlugin("celleditor"),t=r.headerCt.items.findIndex("name",e)-1,n.startEditByPosition({row:r.getSelectionModel().getCurrentPosition().rowIdx,column:t}),n.activeEditor.field.onTriggerClick()},addRecords:function(){var e,t,n,r;for(n=arguments[arguments.length-1],e=0,t=arguments.length;e<t;e++)(r=arguments[e])!==n&&((r=n.to.getStore().add(r)[0]).isNew=!0);if(n.submit)return click(button("Apply"))},addRecord:function(e,t){var n;return(n=(t=t||[]).to||this.grid()).getStore().add(e),n.getSelectionModel().select(n.getStore().last())},updateRecord:function(e,t){var n,r,i,o;for(n in r=((t=t||[]).to||this.grid()).getSelectionModel().getSelection()[0],i=[],e)o=e[n],i.push(r.set(n,o));return i},selectAssociation:function(t,n,e){var r;return r=function(e){return expandRowCombo(t),wait(function(){return select(n,{"in":combobox(t)}),e()})},e?r(e):new Promise(function(e){return r(e)})},valuesInColumn:function(e,t){var n,r,i,o;for(null==t&&(t={}),o=[],n=r=0,i=(t["in"]||this.grid()).getStore().getCount()-1;0<=i?r<=i:i<=r;n=0<=i?++r:--r)o.push(valueInCell(e,n,t));return o},valueInCell:function(t,e,n){var r,i;return null==n&&(n={}),i=(r=n["in"]||this.grid()).getStore().getAt(e),t=r.headerCt.items.findBy(function(e){return e.name===t}),Ext.DomQuery.select("table[data-recordid="+i.internalId+"] tbody tr td.x-grid-cell-"+t.id+" div")[0].innerHTML},selectAllRows:function(e){var t;return null==e&&(e={}),(t=e["in"]||this.grid()).getSelectionModel().selectRange(0,t.getStore().getCount()-1)},rowDisplayValues:function(e){var t,n,r,i;return null==e&&(e={}),t=e["in"]||this.grid(),r=e.of||t.getSelectionModel().getSelection()[0],i=[],Ext.each(t.columns,function(e){if(e.isVisible())return i.push(e)}),n=-1,Ext.Array.map(Ext.DomQuery.select('table[data-recordid="'+r.internalId+'"] tbody tr td div.x-grid-cell-inner'),function(e){return"boolean"===i[++n].type?r.get(i[n].name):e.innerHTML})},selectLastRow:function(e){var t;return null==e&&(e={}),(t=e["in"]||this.grid()).getSelectionModel().select(t.getStore().getCount()-1)},selectFirstRow:function(e){return null==e&&(e={}),(e["in"]||this.grid()).getSelectionModel().select(0)},selectRow:function(e,t){return null==t&&(t={}),(t["in"]||this.grid()).getSelectionModel().select(e)},editLastRow:function(e){var t,n,r,i;for(n in t=e,r=Ext.ComponentQuery.query("grid")[0].getStore().last(),i=[],t)i.push(r.set(n,t[n]));return i},completeEditing:function(e){return(e=e||this.grid()).getPlugin("celleditor").completeEdit()},dblclickRow:function(e){var t,n,r;return null==e&&(e={}),n=(e["in"]||this.grid()).getSelectionModel().getSelection()[0],r=Ext.DomQuery.select('table[data-recordid="'+n.internalId+'"] tbody tr td div')[0],t=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),r.dispatchEvent(t)}})}).call(this);